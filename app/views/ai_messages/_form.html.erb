<%= form_with(model: ai_message, local: false, html: { id: dom_id(ai_message, "form")}) do |form| %>
<%# <%= form_with(model: ai_message, local: true, html: { id: dom_id(ai_message, "form"), data: { turbo: false } }) do |form| %>
  <div class="mb-3">
    <div class="input-group">
      <%= form.text_field :body, class: "form-control", required: false, id:"ai_body", placeholder: "How can I help you?" %>
      <%= form.submit "Ask ", class: "input-group-text", id: "ask", onclick: "sendQuery()" %>
    </div>
  </div>
  <div>
    <%= form.hidden_field :job_listing_id, value: job_listing.id %>
  </div>
<% end %>

<!-- Loading icon -->
<div id="loading-icon" style="display: none;" class="text-center">
  <%= image_tag "loading.gif", width: 200 %>
</div>

<script>
  // Function to handle form submission
  function sendQuery() {
    // Show loading icon
    document.getElementById('loading-icon').style.display = 'block';
  }

  // Listen for form submission
  document.getElementById('ask').addEventListener('click', sendQuery);
</script>
